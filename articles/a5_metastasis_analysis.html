<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5. Analysis of metastatic patterns of MSK-MetTropism • INCOMMON</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="5. Analysis of metastatic patterns of MSK-MetTropism">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">INCOMMON</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/INCOMMON.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a1_priors_k_m.html">1. Prior distribution of mutation copy number and multiplicity from PCAWG</a></li>
    <li><a class="dropdown-item" href="../articles/a2_classify_mutations.html">2. Inference of mutation copy number and multiplicity</a></li>
    <li><a class="dropdown-item" href="../articles/a3_mutant_dosage.html">3. Gene mutant dosage</a></li>
    <li><a class="dropdown-item" href="../articles/a4_survival_analysis.html">4. Survival analysis of MSK-MetTropism</a></li>
    <li><a class="dropdown-item" href="../articles/a5_metastasis_analysis.html">5. Analysis of metastatic patterns of MSK-MetTropism</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/caravagnalab/INCOMMON/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>5. Analysis of metastatic patterns of MSK-MetTropism</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/caravagnalab/INCOMMON/blob/main/vignettes/a5_metastasis_analysis.Rmd" class="external-link"><code>vignettes/a5_metastasis_analysis.Rmd</code></a></small>
      <div class="d-none name"><code>a5_metastasis_analysis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">INCOMMON</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'cli::num_ansi_colors' by</span></span>
<span><span class="co">#&gt; 'crayon::num_ansi_colors' when loading 'INCOMMON'</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cli.r-lib.org" class="external-link">cli</a></span><span class="op">)</span></span></code></pre></div>
<p>In this vignette we carry out survival analysis based on INCOMMON
classification of samples of pancreatic cancer (PAAD) patients of the
MSK-MetTropsim cohort.</p>
<div class="section level2">
<h2 id="metastatic-propensity-of-paad-samples">5.2 Metastatic propensity of PAAD samples<a class="anchor" aria-label="anchor" href="#metastatic-propensity-of-paad-samples"></a>
</h2>
<div class="section level3">
<h3 id="metastatic-propensity-of-fully-incactivated-tp53">5.2.1 Metastatic propensity of fully incactivated TP53<a class="anchor" aria-label="anchor" href="#metastatic-propensity-of-fully-incactivated-tp53"></a>
</h3>
<p>We can analyse the metastatic propensity of primary breast tumor
genomes containing TP53 mutations by using function
<code>met_propensity</code>. This function implements a logistic
regression to fit the Binomial probability of developing metastasis
based on the interpreted mutant genome, with the mutant gene without CNA
(here, Mutant TP53 without LOH) as reference.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"MSK_PAAD_output"</span><span class="op">)</span></span>
<span><span class="va">MSK_PAAD_output</span> <span class="op">=</span> <span class="fu"><a href="../reference/met_propensity.html">met_propensity</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MSK_PAAD_output</span>, tumor_type <span class="op">=</span> <span class="st">'PAAD'</span>, gene <span class="op">=</span> <span class="st">'CDKN2A'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(id)`</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">#&gt;   gene   class          OR   low    up p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> CDKN2A High Dosage  3.46  1.21  9.24  0.015<span style="text-decoration: underline;">3</span></span></span></code></pre></div>
<p>From this analysis it emerges that high dosage CDKN2A have more than
a three-fold increase in risk to metastatise (OR = 3.46, p.value =
0.015) with respect to mutant samples a balanced mutant dosage.</p>
</div>
<div class="section level3">
<h3 id="metastatic-propensity-for-the-top-mutant-genes-in-brca">5.2.2 Metastatic propensity for the top mutant genes in BRCA<a class="anchor" aria-label="anchor" href="#metastatic-propensity-for-the-top-mutant-genes-in-brca"></a>
</h3>
<p>We extend this analysis to multiple genes, focusing on the 10 most
frequently mutated ones.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_genes</span> <span class="op">=</span> <span class="va">MSK_PAAD_output</span><span class="op">$</span><span class="va">input</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">top_genes</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="va">top_genes</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">MSK_PAAD_output</span> <span class="op">=</span> <span class="fu"><a href="../reference/met_propensity.html">met_propensity</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MSK_PAAD_output</span>, tumor_type <span class="op">=</span> <span class="st">'PAAD'</span>, gene <span class="op">=</span> <span class="va">g</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualising-metastatic-propensity-odds-ratio">5.2.2 Visualising metastatic propensity odds ratio<a class="anchor" aria-label="anchor" href="#visualising-metastatic-propensity-odds-ratio"></a>
</h3>
<p>INCOMMON provides the function <code>plot_met_volcano</code> to
visualise metastatic propensity odds ratios in a volcano plot.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_met_volcano.html">plot_met_volcano</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MSK_PAAD_output</span>, tumor_type <span class="op">=</span> <span class="st">'PAAD'</span><span class="op">)</span></span></code></pre></div>
<p><img src="a5_metastasis_analysis_files/figure-html/unnamed-chunk-4-1.png" width="300"></p>
<p>In addition to CDKN2A, among the 10 most frequently mutant genes in
PAAD, a high dosage of KRAS seems to reduce the risk of metastatisation
(OR = 0.59, p.value = 0.04). Given the strong worsening of survival
outcomes related to high KRAS dosage in PAAD, this effect may be
explained by the fact that the death rate in this configuration is high
enough not to allow the annotation of metastases in the patients’
electronic health records.</p>
</div>
</div>
<div class="section level2">
<h2 id="metastatic-tropism-of-brca-samples">5.3 Metastatic tropism of BRCA samples<a class="anchor" aria-label="anchor" href="#metastatic-tropism-of-brca-samples"></a>
</h2>
<div class="section level3">
<h3 id="tropism-to-liver-metastases-of-kras-pancreatic-cancer-with-high-dosage">5.3.1 Tropism to liver metastases of KRAS pancreatic cancer with
high dosage<a class="anchor" aria-label="anchor" href="#tropism-to-liver-metastases-of-kras-pancreatic-cancer-with-high-dosage"></a>
</h3>
<p>We can analyse the organotropism of metastatic pancreatic tumor
genomes containing KRAS mutations by using function
<code>met_tropsim</code>. Similarly to the metastatic propensity
analysis, this function implements a logistic regression to fit the
Binomial probability of developing metastasis towards a specific
metastatic site (here the Liver, as example), based on the mutant gene
dosage, with the balanced dosage as reference.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MSK_PAAD_output</span> <span class="op">=</span> <span class="fu"><a href="../reference/met_tropism.html">met_tropism</a></span><span class="op">(</span><span class="va">MSK_PAAD_output</span>, tumor_type <span class="op">=</span> <span class="st">'PAAD'</span>, gene <span class="op">=</span> <span class="st">'KRAS'</span>, metastatic_site <span class="op">=</span> <span class="st">'Liver'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">#&gt;   gene  metastatic_site class          OR   low    up p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> KRAS  Liver           High Dosage  1.72  1.09  2.77  0.023<span style="text-decoration: underline;">2</span></span></span></code></pre></div>
<p>There is odds ratio (OR) of metastatising to the Liver for high
dosage KRAS mutant pancreatic cancer is almost two-fold (OR = 1.71,
p.value = 0.023) with respect to mutant samples with balanced
dosage.</p>
</div>
<div class="section level3">
<h3 id="tropism-of-top-mutant-genes-in-paad-to-the-liver">5.3.2 Tropism of top mutant genes in PAAD to the Liver<a class="anchor" aria-label="anchor" href="#tropism-of-top-mutant-genes-in-paad-to-the-liver"></a>
</h3>
<p>We extend this analysis to multiple genes, focusing on the 10 most
frequently mutated ones and the top 10 most frequent metastatic
sites.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_sites</span> <span class="op">=</span> <span class="va">MSK_PAAD_output</span><span class="op">$</span><span class="va">clinical_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">METASTATIC_SITE</span> <span class="op">!=</span> <span class="st">'Unspecified'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">METASTATIC_SITE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">METASTATIC_SITE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="va">top_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="va">top_sites</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">MSK_PAAD_output</span> <span class="op">=</span> <span class="fu"><a href="../reference/met_tropism.html">met_tropism</a></span><span class="op">(</span><span class="va">MSK_PAAD_output</span>, gene <span class="op">=</span> <span class="va">g</span>, tumor_type <span class="op">=</span> <span class="st">'PAAD'</span>, metastatic_site <span class="op">=</span> <span class="va">m</span><span class="op">)</span> </span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualising-metastatic-tropism">5.3.3 Visualising metastatic tropism<a class="anchor" aria-label="anchor" href="#visualising-metastatic-tropism"></a>
</h3>
<p>INCOMMON provides the function <code>plot_tropism</code> to visualise
metastatic tropism odds ratios by metastatic site.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_tropism.html">plot_tropism</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MSK_PAAD_output</span>, tumor_type <span class="op">=</span> <span class="st">'PAAD'</span><span class="op">)</span></span></code></pre></div>
<p><img src="a5_metastasis_analysis_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
<p>Interestingly, a high dosage of KRAS only increases the odds of
metastatisation to the liver, among the first 10 most frequent
metastatisation sites, highlighting a very specific organotropic pattern
for this mutant dosage configuration.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicola Calonaci, Giulio Caravagna.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
