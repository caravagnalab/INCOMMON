# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = Inf),
show.legend = F,
size = 1,
hjust = 1)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = Inf),
show.legend = F,
size = 1,
hjust = -1)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 400),
show.legend = F,
size = 1,
hjust = -1)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 400),
show.legend = F,
size = 1
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(200, 400),
size = 1
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(200, 400),
size = 1
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample)+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(200, 400),
size = 1
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(150, 400),
size = 1
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(150, 400),
force_pull = -1,
size = 1
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(150, 400),
force_pull = -5,
size = 1
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(150, 400),
force_pull = -5,
size = 1,linetype = 'longdash'
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(150, 400),
force_pull = -5,
size = 1,
segment.linetype = 2
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
p_1d
ggsave(plot = p_1d, filename = './scripts/cohort_vaf_1d.pdf',
width = 8, height = 6)
ggsave(plot = p_1d, filename = './scripts/cohort_vaf_1d.pdf',
width = 8, height = 8)
ggsave(plot = p_1d, filename = './plots/Figure 1/cohort_vaf_1d.pdf',
width = 8, height = 8)
ggsave(plot = p_1d, filename = './plots/Figure 2/cohort_vaf_1d.pdf',
width = 8, height = 8)
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(150, 400),
force_pull = -5,
size = 3,
segment.linetype = 2
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
ggsave(plot = p_1d, filename = './plots/Figure 2/cohort_vaf_1d.pdf',
width = 8, height = 8)
p_1d = all_muts %>%
rename(cluster = viber_cluster) %>%
mutate(cluster = ifelse(is.na(cluster), 'Other', cluster)) %>%
# mutate(cluster = ifelse(cluster == 'Truncal', 'C', cluster)) %>%
mutate(cluster = ifelse(patient == 'CT344' & cluster == 'H1', 'S3', cluster)) %>%
mutate(cluster = ifelse(patient == 'TS187' & cluster == 'S4', 'Other', cluster)) %>%
# mutate(cluster = factor(cluster, levels = c('S1', 'S2', 'S3', 'C', 'Other') %>% rev())) %>%
mutate(
sample = case_when(
sample == 1 ~ 'T1-',
sample == 2 ~ 'T1+',
sample == 3 ~ 'T2-',
sample == 4 ~ 'T2+'
)
) %>%
# filter(sample %in% c('T2-', 'T2+')) %>%
filter(VAF > 0 , VAF < .75) %>%
ggplot(aes(x = VAF, fill = cluster))+
geom_histogram(binwidth = 0.01)+
ggrepel::geom_label_repel(
data = . %>% filter(is_driver, cluster != 'Other', !is.na(cluster)),
aes(label = driver_label, y = 0),
show.legend = F,
ylim = c(150, 400),
force_pull = -5,
size = 2,
segment.linetype = 2
)+
scale_fill_manual(values = c('Truncal' = 'firebrick', 'S1' = 'goldenrod1', 'S2' = 'forestgreen','S3' = 'purple3', 'S4' = 'deepskyblue', 'Other' = 'gainsboro'))+
scale_x_continuous(breaks = scales::pretty_breaks(n=2))+
scale_y_continuous(breaks = scales::pretty_breaks(n=2))+
CNAqc:::my_ggplot_theme(cex = .8)+
labs(y = '# Mutations')+
ggh4x::facet_grid2(~patient~sample, scales = 'free_y')+
theme(
strip.text.y.right = element_text(angle = 0)
)
ggsave(plot = p_1d, filename = './plots/Figure 2/cohort_vaf_1d.pdf',
width = 8, height = 8)
