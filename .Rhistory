tcga %>%
filter(QC) %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
# filter(QC) %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
filter(QC) %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
mutate(match = (map_class==true_class)) %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
mutate(match = (map_class==true_class)) %>%
# filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
mutate(match = (map_class==true_class)) %>%
# filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
p1 = tcga %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
p1
p2 = tcga %>%
group_by(match, true_class) %>%
reframe(n=n()) %>%
group_by(true_class) %>%
reframe(N = sum(n), match, n) %>%
mutate(f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
facet_wrap(~true_class)+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
p2
p3 = tcga %>%
# filter(true_class == 'm=1') %>%
group_by(match, true_class, ploidy) %>%
reframe(n=n()) %>%
group_by(true_class, ploidy) %>%
reframe(N = sum(n), match, n) %>%
mutate(f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
facet_grid(~true_class~ploidy, )+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
p3
hmf = hmf %>% mutate(match = (map_class==true_class))
p1 = hmf %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
p2 = hmf %>%
group_by(match, true_class) %>%
reframe(n=n()) %>%
group_by(true_class) %>%
reframe(N = sum(n), match, n) %>%
mutate(f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
facet_wrap(~true_class)+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
p3 = hmf %>%
# filter(true_class == 'm=1') %>%
group_by(match, true_class, ploidy) %>%
reframe(n=n()) %>%
group_by(true_class, ploidy) %>%
reframe(N = sum(n), match, n) %>%
mutate(f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
facet_grid(~true_class~ploidy, )+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
plot_hmf =
((p1+p2)/p3)+
plot_layout(heights = c(1,3), guides = 'collect')&
theme(legend.position = 'bottom')
p2
p3 = hmf %>%
# filter(true_class == 'm=1') %>%
group_by(match, true_class, ploidy) %>%
reframe(n=n()) %>%
group_by(true_class, ploidy) %>%
reframe(N = sum(n), match, n) %>%
mutate(f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
facet_grid(~true_class~ploidy, )+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
library(patchwork)
plot_hmf =
((p1+p2)/p3)+
plot_layout(heights = c(1,3), guides = 'collect')&
theme(legend.position = 'bottom')
plot_hmf
library(tidyverse)
tcga = readRDS('./results/higher_ploidy/high_level_model_tcga_fit_drivers.rds')
hmf = readRDS('./results/higher_ploidy/high_level_model_hmf_fit_drivers.rds')
tcga = tcga %>%
mutate(match = (map_class==true_class))
tcga %>%
filter(QC) %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
filter(QC) %>%
# filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
# filter(QC) %>%
# filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
filter(QC) %>%
# filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
filter(QC) %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
filter(QC) %>%
filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
mutate(match = (map_class==true_class)) %>%
# filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
mutate(match = (map_class==true_class)) %>%
filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
p1 = tcga %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
p2 = tcga %>%
group_by(match, true_class) %>%
reframe(n=n()) %>%
group_by(true_class) %>%
reframe(N = sum(n), match, n) %>%
mutate(f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
facet_wrap(~true_class)+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
p3 = tcga %>%
# filter(true_class == 'm=1') %>%
group_by(match, true_class, ploidy) %>%
reframe(n=n()) %>%
group_by(true_class, ploidy) %>%
reframe(N = sum(n), match, n) %>%
mutate(f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
facet_grid(~true_class~ploidy, )+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
library(patchwork)
plot_tcga =
((p1+p2)/p3)+
plot_layout(heights = c(1,3), guides = 'collect')&
theme(legend.position = 'bottom')
plot_tcga
hmf = hmf %>% mutate(match = (map_class==true_class))
p1 = hmf %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
p2 = hmf %>%
group_by(match, true_class) %>%
reframe(n=n()) %>%
group_by(true_class) %>%
reframe(N = sum(n), match, n) %>%
mutate(f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
facet_wrap(~true_class)+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
p3 = hmf %>%
# filter(true_class == 'm=1') %>%
group_by(match, true_class, ploidy) %>%
reframe(n=n()) %>%
group_by(true_class, ploidy) %>%
reframe(N = sum(n), match, n) %>%
mutate(f = n/N) %>%
ggplot(aes(x = '', y = f, fill = match))+
geom_bar(stat = 'identity')+
geom_text(aes(label = paste0('N = ', n)), color = 'white', position = position_stack(vjust = .5))+
scale_fill_manual(values = c('TRUE' = 'forestgreen', 'FALSE' = 'indianred3'))+
coord_polar(theta = 'y')+
facet_grid(~true_class~ploidy, )+
CNAqc:::my_ggplot_theme(cex = .8)+
xlab('')+ylab('')+
guides(fill = guide_legend(title = 'Class match'))
library(patchwork)
plot_hmf =
((p1+p2)/p3)+
plot_layout(heights = c(1,3), guides = 'collect')&
theme(legend.position = 'bottom')
plot_hmf
library(tidyverse)
tcga = readRDS('./results/higher_ploidy/high_level_model_tcga_fit_drivers.rds')
hmf = readRDS('./results/higher_ploidy/high_level_model_hmf_fit_drivers.rds')
tcga = tcga %>%
mutate(match = (map_class==true_class))
tcga %>%
filter(QC) %>%
filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
# filter(QC) %>%
# filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
filter(QC) %>%
# filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
filter(QC) %>%
filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
filter(QC) %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
mutate(match = (map_class==true_class)) %>%
filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
mutate(match = (map_class==true_class)) %>%
# filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
library(tidyverse)
tcga = readRDS('./results/higher_ploidy/high_level_model_tcga_fit_drivers.rds')
hmf = readRDS('./results/higher_ploidy/high_level_model_hmf_fit_drivers.rds')
tcga = tcga %>%
mutate(match = (map_class==true_class))
tcga %>%
filter(QC) %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
# filter(QC) %>%
# filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
filter(QC) %>%
# filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
tcga %>%
# filter(QC) %>%
filter(map_posterior >= .5) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
mutate(match = (map_class==true_class)) %>%
# filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
hmf %>%
mutate(match = (map_class==true_class)) %>%
filter(map_posterior >= .45) %>%
# filter(entropy <= 1.04) %>%
# filter(ploidy <= 4) %>%
# filter(map_posterior>.50) %>%
# filter(quality >= 10) %>%
group_by(match) %>%
reframe(n=n()) %>%
mutate(N = sum(n), f = n/N)
prio§
setwd('~/Documents/GitHub/INCOMMON/')
